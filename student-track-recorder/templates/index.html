    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Track Recorder</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Landing Page -->
    <div id="landingPage" class="page active">
        <div class="container">
            <div class="logo-section">
                <h1>🎓 Student Track Recorder</h1>
                <p>Complete activity tracking system for educational institutions</p>
            </div>

            <div class="access-cards">
                <div class="access-card faculty-card" onclick="showFacultyLogin()">
                    <div class="card-icon">👨‍🏫</div>
                    <h3>Faculty Access</h3>
                    <p>Manage courses, students, and activities</p>
                    <button class="access-btn faculty-btn">Faculty Login</button>
                </div>

                <div class="access-card student-card" onclick="showStudentLogin()">
                    <div class="card-icon">👨‍🎓</div>
                    <h3>Student Access</h3>
                    <p>View activities and track participation</p>
                    <button class="access-btn student-btn">Student Login</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Faculty Login Page -->
    <div id="facultyLoginPage" class="page">
        <div class="container">
            <div class="login-container">
                <button class="back-btn" onclick="showLandingPage()">← Back</button>
                <div class="login-header">
                    <h2>👨‍🏫 Faculty Login</h2>
                    <p>Enter your credentials to continue</p>
                </div>

                <form id="facultyLoginForm" class="login-form">
                    <div class="form-group">
                        <label for="facultyAccountType">Account Type</label>
                        <select id="facultyAccountType">
                            <option value="main">Main Admin</option>
                            <option value="secondary">Secondary Admin</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="facultyUserId">User ID</label>
                        <input type="text" id="facultyUserId" required>
                    </div>
                    <div class="form-group">
                        <label for="facultyPassword">Password</label>
                        <input type="password" id="facultyPassword" required>
                    </div>
                    <button type="submit" class="submit-btn">Login</button>
                    <div id="facultyLoginError" class="error-message"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Student Login Page -->
    <div id="studentLoginPage" class="page">
        <div class="container">
            <div class="login-container">
                <button class="back-btn" onclick="showLandingPage()">← Back</button>
                <div class="login-header">
                    <h2>👨‍🎓 Student Login</h2>
                    <p>Enter your details to access your portfolio</p>
                </div>

                <form id="studentLoginForm" class="login-form">
                    <div class="form-group">
                        <label for="studentRoll">Roll Number</label>
                        <input type="text" id="studentRoll" required>
                    </div>
                    <div class="form-group">
                        <label for="studentEmail">Email ID</label>
                        <input type="email" id="studentEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="studentPassword">Secret Password</label>
                        <input type="password" id="studentPassword" required>
                    </div>
                    <button type="submit" class="submit-btn">Login</button>
                    <div id="studentLoginError" class="error-message"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Faculty Dashboard -->
    <div id="facultyDashboard" class="page">
        <div class="header">
            <h1>Faculty Dashboard</h1>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="container">
            <!-- Course Selection -->
            <div id="courseSelection" class="section active">
                <div class="section-header">
                    <h2>Select Course</h2>
                    <button class="add-btn" onclick="showAddCourseModal()">+ Add Course</button>
                </div>

                <div id="coursesList" class="cards-grid"></div>
            </div>

            <!-- Year Selection -->
            <div id="yearSelection" class="section">
                <div class="section-header">
                    <h2 id="yearSectionTitle">Select Year</h2>
                    <div class="section-actions">
                        <button class="back-btn" onclick="backToCourses()">← Back to Courses</button>
                        <button class="add-btn" onclick="showAddYearModal()">+ Add Year</button>
                    </div>
                </div>

                <div id="yearsList" class="cards-grid"></div>
            </div>

            <!-- Section Selection -->
            <div id="sectionSelection" class="section">
                <div class="section-header">
                    <h2 id="sectionSectionTitle">Select Section</h2>
                    <div class="section-actions">
                        <button class="back-btn" onclick="backToYears()">← Back to Years</button>
                        <button class="add-btn" onclick="showAddSectionModal()">+ Add Section</button>
                    </div>
                </div>

                <div id="sectionsList" class="cards-grid"></div>
            </div>

            <!-- Students & Activities Management -->
            <div id="studentsActivities" class="section">
                <div class="section-header">
                    <h2 id="studentsActivitiesTitle">Students & Activities</h2>
                    <button class="back-btn" onclick="backToSections()">← Back to Sections</button>
                </div>

                <div class="management-tabs">
                    <button class="tab-btn active" onclick="switchTab('students')">👥 Students</button>
                    <button class="tab-btn" onclick="switchTab('activities')">📋 Activities</button>
                    <button class="tab-btn" onclick="openAttendancePage()">🗓️ Attendance</button>
                    <button class="tab-btn" onclick="switchTab('messages')">💬 Messages</button>
                    <button class="tab-btn" onclick="app.openScrutinyManager()">📝 View to verify</button>
                    <button id="secondaryAdminTabBtn" class="tab-btn" onclick="switchTab('secondaryAdmins')">🧑‍🏫 Secondary Admins</button>
                </div>

                <!-- Students Tab -->
                <div id="studentsTab" class="tab-content active">
                    <div class="tab-header">
                        <h3>Students</h3>
                        <button class="add-btn" style="width:auto;padding:8px 14px;font-size:0.9rem;" onclick="showAddStudentModal()">+ Add Student</button>
                    </div>
                    <div id="studentsList" class="items-list"></div>
                </div>

                <!-- Activities Tab -->
                <div id="activitiesTab" class="tab-content">
                    <div class="tab-header">
                        <h3>Activities</h3>
                        <div>
                            <button class="add-btn" onclick="showAddActivityModal()">+ Add Activity</button>
                        </div>
                    </div>
                    <div id="activitiesList" class="items-list"></div>
                </div>

                <!-- Secondary Admins Tab (visible only to main admin) -->
                <div id="secondaryAdminsTab" class="tab-content">
                    <div class="tab-header">
                        <h3>Secondary Admins</h3>
                        <div>
                            <button id="addSecondaryAdminBtn" class="add-btn" onclick="showAddSecondaryAdminModal()">+ Add Secondary Admin</button>
                        </div>
                    </div>
                    <div id="secondaryAdminsList" class="items-list"></div>
                </div>

                <!-- Messages Tab -->
                <div id="messagesTab" class="tab-content">
                    <div class="tab-header">
                        <h3>Messages</h3>
                        <div class="section-actions">
                            <button class="add-btn" onclick="app.openGroupsManager()">Group</button>
                        </div>
                    </div>
                    <div class="muted" style="margin-bottom:10px;">Select a student to chat or open Group</div>
                    <div id="messagesStudentsList" class="items-list"></div>
                </div>

                            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="page">
        <div class="header">
            <h1>Student Portfolio</h1>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="container">
            <div id="studentProfile" class="student-profile"></div>
            <div id="studentActivities" class="student-activities"></div>
            <div id="studentAttendance" class="student-activities"></div>
            <div id="studentMessages" class="student-activities"></div>
            <div id="studentCertificates" class="student-activities"></div>
                    </div>
    </div>

    <!-- Modals -->
    <!-- Student Attendance Modal -->
    <div id="studentAttendanceModal" class="modal">
        <div class="modal-content" style="max-width: 520px;">
            <div class="modal-header">
                <h3>My Attendance</h3>
                <button class="close-btn" onclick="closeModal('studentAttendanceModal')">&times;</button>
            </div>
            <div style="padding: 16px;">
                <div class="form-group">
                    <label for="studentAttendanceSubject">Select Subject</label>
                    <select id="studentAttendanceSubject"></select>
                </div>
                <div class="calendar-nav">
                    <button id="studentCalPrevBtn" class="cancel-btn">Prev</button>
                    <div id="studentMonthLabel"></div>
                    <button id="studentCalNextBtn" class="cancel-btn">Next</button>
                </div>
                <div class="calendar calendar-compact" id="studentCalendarGrid"></div>
                <div id="studentAttendanceDates" class="muted" style="margin-top:8px;"></div>
            </div>
        </div>
    </div>

    <!-- Student Dispute Status Modal -->
    <div id="studentDisputeStatusModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3>My Dispute Status</h3>
                <button class="close-btn" onclick="closeModal('studentDisputeStatusModal')">&times;</button>
            </div>
            <div style="padding: 16px;">
                <div class="form-group">
                    <label for="disputeStatusSubject">Select Subject</label>
                    <select id="disputeStatusSubject"></select>
                </div>
                <div id="studentIssuesList" class="items-list"></div>
            </div>
        </div>
    </div>

    <!-- Student Dispute Modal -->
    <div id="studentDisputeModal" class="modal">
        <div class="modal-content" style="max-width: 560px;">
            <div class="modal-header">
                <h3>Raise Attendance Dispute</h3>
                <button class="close-btn" onclick="closeModal('studentDisputeModal')">&times;</button>
            </div>
            <div style="padding: 16px;">
                <div class="form-group">
                    <label for="disputeSubject">Select Subject</label>
                    <select id="disputeSubject"></select>
                </div>
                <div class="calendar-nav">
                    <button id="disputePrevBtn" class="cancel-btn">Prev</button>
                    <div id="disputeMonthLabel"></div>
                    <button id="disputeNextBtn" class="cancel-btn">Next</button>
                </div>
                <div class="calendar calendar-compact" id="disputeCalendar"></div>
                <div class="form-group" style="margin-top:10px;">
                    <label for="disputeDescription">Describe the issue</label>
                    <textarea id="disputeDescription" rows="3" placeholder="Describe your attendance issue (e.g., present on 2025-09-10 but marked absent)"></textarea>
                </div>
                <div class="form-actions" style="justify-content:flex-end;">
                    <button class="cancel-btn" onclick="closeModal('studentDisputeModal')">Cancel</button>
                    <button class="submit-btn" onclick="submitStudentDispute()">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Course Modal -->
    <div id="addCourseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Course</h3>
                <button class="close-btn" onclick="closeModal('addCourseModal')">&times;</button>
            </div>
            <form id="addCourseForm">
                <div class="form-group">
                    <label for="courseName">Course Name</label>
                    <input type="text" id="courseName" placeholder="e.g., B.Tech, M.Tech, PhD" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('addCourseModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Save Course</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Year Modal -->
    <div id="addYearModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Year</h3>
                <button class="close-btn" onclick="closeModal('addYearModal')">&times;</button>
            </div>
            <form id="addYearForm">
                <div class="form-group">
                    <label for="yearName">Year Name</label>
                    <input type="text" id="yearName" placeholder="e.g., 1st Year, 2nd Year" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('addYearModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Save Year</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Section Modal -->
    <div id="addSectionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Section</h3>
                <button class="close-btn" onclick="closeModal('addSectionModal')">&times;</button>
            </div>
            <form id="addSectionForm">
                <div class="form-group">
                    <label for="sectionName">Section Name</label>
                    <input type="text" id="sectionName" placeholder="e.g., A Section, B Section, F Section" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('addSectionModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Save Section</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Student Modal -->
    <div id="addStudentModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Student</h3>
                <button class="close-btn" onclick="closeModal('addStudentModal')">&times;</button>
            </div>
            <form id="addStudentForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="studentName">Student Name</label>
                        <input type="text" id="studentName" required>
                    </div>
                    <div class="form-group">
                        <label for="studentRollNo">Roll Number</label>
                        <input type="text" id="studentRollNo" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="studentEmailId">Email ID</label>
                        <input type="email" id="studentEmailId" required>
                    </div>
                    <div class="form-group">
                        <label for="studentPhone">Phone Number</label>
                        <input type="tel" id="studentPhone" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="fatherName">Father's Name</label>
                        <input type="text" id="fatherName" required>
                    </div>
                    <div class="form-group">
                        <label for="fatherPhone">Father's Phone</label>
                        <input type="tel" id="fatherPhone" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="motherName">Mother's Name</label>
                        <input type="text" id="motherName" required>
                    </div>
                    <div class="form-group">
                        <label for="motherPhone">Mother's Phone</label>
                        <input type="tel" id="motherPhone" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="studentSecretPassword">Secret Password</label>
                    <input type="password" id="studentSecretPassword" required>
                </div>

                <div class="form-group">
                    <label for="studentPhoto">Student Photo</label>
                    <input type="file" id="studentPhoto" accept="image/*">
                </div>

                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('addStudentModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Save Student</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Activity Modal -->
    <div id="addActivityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Activity</h3>
                <button class="close-btn" onclick="closeModal('addActivityModal')">&times;</button>
            </div>
            <form id="addActivityForm">
                <div class="form-group">
                    <label for="activityName">Activity Name</label>
                    <input type="text" id="activityName" required>
                </div>
                <div class="form-group">
                    <label for="activityDetails">Activity Details</label>
                    <textarea id="activityDetails" rows="4" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('addActivityModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Save Activity</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Student Activity Assignment Modal -->
<div id="assignActivityModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Assign Activities & Remarks</h3>
            <button class="close-btn" onclick="closeModal('assignActivityModal')">&times;</button>
        </div>
        <form id="assignActivityForm">
            <div class="form-group">
                <label>Select Activities</label>
                <div id="activitiesCheckboxes" class="checkbox-group"></div>
            </div>
            <div class="form-group">
                <label for="studentRemarks">Remarks/Status</label>
                <textarea id="studentRemarks" rows="3" placeholder="Enter any remarks or status information..." required></textarea>
            </div>
            <div class="form-actions">
                <button type="button" class="cancel-btn" onclick="closeModal('assignActivityModal')">Cancel</button>
                <button type="submit" class="submit-btn">Save Assignment</button>
            </div>
        </form>
    </div>
</div>

    <!-- Add Certificate Modal -->
    <div id="addCertificateModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Certificate</h3>
                <button class="close-btn" onclick="closeModal('addCertificateModal')">&times;</button>
            </div>
            <form id="addCertificateForm">
                <div class="form-group">
                    <label for="certificateName">Certificate Name</label>
                    <input type="text" id="certificateName" placeholder="e.g., Hackathon Winner 2025" required>
                </div>
                <div class="form-group">
                    <label for="certificateFile">Upload Certificate (any file type)</label>
                    <input type="file" id="certificateFile" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('addCertificateModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Upload</button>
                </div>
                <div style="margin-top:10px;">
                    <h4>Existing Certificates</h4>
                    <div id="certificatesListForStudent" class="items-list"></div>
                </div>
            </form>
        </div>
    </div>

    <!-- Student Scrutiny (Upload to verify) Modal -->
    <div id="studentScrutinyModal" class="modal">
        <div class="modal-content" style="max-width: 560px;">
            <div class="modal-header">
                <h3>Upload Certificate to Verify</h3>
                <button class="close-btn" onclick="closeModal('studentScrutinyModal')">&times;</button>
            </div>
            <form id="studentScrutinyForm">
                <div class="form-group">
                    <label for="scrutinyFile">Attach Certificate (any file type)</label>
                    <input type="file" id="scrutinyFile" required />
                </div>
                <div class="form-group">
                    <label for="scrutinyDescription">Describe Certificate</label>
                    <textarea id="scrutinyDescription" rows="3" placeholder="Short description about the certificate" required></textarea>
                </div>
                <div class="form-actions" style="justify-content:flex-end;">
                    <button type="button" class="cancel-btn" onclick="closeModal('studentScrutinyModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Send</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Student Scrutiny Status Modal -->
    <div id="studentScrutinyStatusModal" class="modal">
        <div class="modal-content" style="max-width: 760px;">
            <div class="modal-header">
                <h3>Verification Status</h3>
                <button class="close-btn" onclick="closeModal('studentScrutinyStatusModal')">&times;</button>
            </div>
            <div style="padding:16px;">
                <div id="studentScrutinyList" class="items-list" style="max-height:60vh;overflow:auto;"></div>
            </div>
        </div>
    </div>

    <!-- Faculty Scrutiny Review Modal -->
    <div id="scrutinyModal" class="modal">
        <div class="modal-content" style="max-width: 860px;">
            <div class="modal-header">
                <h3>To Verify Certificates</h3>
                <button class="close-btn" onclick="closeModal('scrutinyModal')">&times;</button>
            </div>
            <div style="padding:16px;">
                <div id="scrutinyList" class="items-list" style="max-height:60vh;overflow:auto;"></div>
            </div>
        </div>
    </div>

    <!-- Edit Student Modal -->
    <div id="editStudentModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Student</h3>
                <button class="close-btn" onclick="closeModal('editStudentModal')">&times;</button>
            </div>
            <form id="editStudentForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editStudentName">Student Name</label>
                        <input type="text" id="editStudentName" required>
                    </div>
                    <div class="form-group">
                        <label for="editStudentRollNo">Roll Number</label>
                        <input type="text" id="editStudentRollNo" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editStudentEmailId">Email ID</label>
                        <input type="email" id="editStudentEmailId" required>
                    </div>
                    <div class="form-group">
                        <label for="editStudentPhone">Phone Number</label>
                        <input type="tel" id="editStudentPhone" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editFatherName">Father's Name</label>
                        <input type="text" id="editFatherName" required>
                    </div>
                    <div class="form-group">
                        <label for="editFatherPhone">Father's Phone</label>
                        <input type="tel" id="editFatherPhone" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editMotherName">Mother's Name</label>
                        <input type="text" id="editMotherName" required>
                    </div>
                    <div class="form-group">
                        <label for="editMotherPhone">Mother's Phone</label>
                        <input type="tel" id="editMotherPhone" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="editStudentSecretPassword">Secret Password</label>
                    <input type="password" id="editStudentSecretPassword" required>
                </div>

                <div class="form-group">
                    <label for="editStudentPhoto">Student Photo</label>
                    <input type="file" id="editStudentPhoto" accept="image/*">
                </div>

                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('editStudentModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Update Student</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Activity Modal -->
    <div id="editActivityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Activity</h3>
                <button class="close-btn" onclick="closeModal('editActivityModal')">&times;</button>
            </div>
            <form id="editActivityForm">
                <div class="form-group">
                    <label for="editActivityName">Activity Name</label>
                    <input type="text" id="editActivityName" required>
                </div>
                <div class="form-group">
                    <label for="editActivityDetails">Activity Details</label>
                    <textarea id="editActivityDetails" rows="4" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('editActivityModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Update Activity</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Secondary Admin Modal -->
    <div id="addSecondaryAdminModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Secondary Admin (Teacher/Professor)</h3>
                <button class="close-btn" onclick="closeModal('addSecondaryAdminModal')">&times;</button>
            </div>
            <form id="addSecondaryAdminForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="profName">Name</label>
                        <input type="text" id="profName" required>
                    </div>
                    <div class="form-group">
                        <label for="profUserId">User ID</label>
                        <input type="text" id="profUserId" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="profPassword">Password</label>
                        <input type="password" id="profPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="profEmail">Email</label>
                        <input type="email" id="profEmail" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="profPhone">Phone</label>
                        <input type="tel" id="profPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="profPhoto">Photo</label>
                        <input type="file" id="profPhoto" accept="image/*">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="profFatherName">Father's Name</label>
                        <input type="text" id="profFatherName">
                    </div>
                    <div class="form-group">
                        <label for="profFatherPhone">Father's Phone</label>
                        <input type="tel" id="profFatherPhone">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="profMotherName">Mother's Name</label>
                        <input type="text" id="profMotherName">
                    </div>
                    <div class="form-group">
                        <label for="profMotherPhone">Mother's Phone</label>
                        <input type="tel" id="profMotherPhone">
                    </div>
                </div>
                <div class="form-group">
                    <label for="profSubjects">Subjects (comma-separated)</label>
                    <input type="text" id="profSubjects" placeholder="e.g., English, Civil Engineering" required>
                    <div class="muted" style="font-size:0.85rem;">If more than one, separate by commas.</div>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('addSecondaryAdminModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Secondary Admin Modal -->
    <div id="editSecondaryAdminModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Secondary Admin</h3>
                <button class="close-btn" onclick="closeModal('editSecondaryAdminModal')">&times;</button>
            </div>
            <form id="editSecondaryAdminForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProfName">Name</label>
                        <input type="text" id="editProfName" required>
                    </div>
                    <div class="form-group">
                        <label for="editProfUserId">User ID</label>
                        <input type="text" id="editProfUserId" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProfPassword">Password</label>
                        <input type="password" id="editProfPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="editProfEmail">Email</label>
                        <input type="email" id="editProfEmail" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProfPhone">Phone</label>
                        <input type="tel" id="editProfPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="editProfPhoto">Photo</label>
                        <input type="file" id="editProfPhoto" accept="image/*">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProfFatherName">Father's Name</label>
                        <input type="text" id="editProfFatherName">
                    </div>
                    <div class="form-group">
                        <label for="editProfFatherPhone">Father's Phone</label>
                        <input type="tel" id="editProfFatherPhone">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProfMotherName">Mother's Name</label>
                        <input type="text" id="editProfMotherName">
                    </div>
                    <div class="form-group">
                        <label for="editProfMotherPhone">Mother's Phone</label>
                        <input type="tel" id="editProfMotherPhone">
                    </div>
                </div>
                <div class="form-group">
                    <label for="editProfSubjects">Subjects (comma-separated)</label>
                    <input type="text" id="editProfSubjects" placeholder="e.g., English, Civil Engineering" required>
                    <div class="muted" style="font-size:0.85rem;">If more than one, separate by commas.</div>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('editSecondaryAdminModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Update</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chat Modal -->
    <div id="chatModal" class="modal">
        <div class="modal-content" style="max-width: 840px;">
            <div class="modal-header">
                <div id="chatHeader" class="chat-header" style="display:flex;align-items:center;justify-content:space-between;width:100%;">
                    <div class="chat-peer" style="display:flex;align-items:center;gap:10px;">
                        <img id="chatPeerPhoto" class="avatar" alt="" style="width:40px;height:40px;border-radius:50%;object-fit:cover;display:none;">
                        <div>
                            <h3 id="chatPeerName" style="margin:0;">Chat</h3>
                            <div id="chatPeerMeta" class="muted" style="font-size:0.9rem;"></div>
                        </div>
                    </div>
                    <div class="chat-actions" style="display:flex;align-items:center;gap:8px;">
                        <button id="chatRestrictionBtn" class="add-btn" style="display:none;">Permissions</button>
                        <button class="close-btn" onclick="closeModal('chatModal')" title="Close">&times;</button>
                    </div>
                </div>
            </div>
            <div class="chat-body" id="chatMessages" style="padding:12px; max-height: 55vh; overflow-y:auto; background:#f7fafc;"></div>
            <div class="chat-input" style="display:flex; gap:8px; padding:12px; border-top:1px solid #e2e8f0;">
                <input type="file" id="chatFiles" multiple style="max-width: 260px;">
                <input type="text" id="chatText" placeholder="Type a message..." style="flex:1; padding:8px;">
                <button class="submit-btn" onclick="sendChatMessage()">Send</button>
            </div>
        </div>
    </div>

    <!-- Select Teacher Modal (for Student) -->
    <div id="selectTeacherModal" class="modal">
        <div class="modal-content" style="max-width: 560px;">
            <div class="modal-header">
                <h3>Select Teacher to Chat</h3>
                <button class="close-btn" onclick="closeModal('selectTeacherModal')">&times;</button>
            </div>
            <div style="padding: 16px;">
                <div id="teacherList" class="items-list"></div>
            </div>
        </div>
    </div>

    <!-- Groups Manager Modal -->
    <div id="groupsModal" class="modal">
        <div class="modal-content" style="max-width: 760px;">
            <div class="modal-header" style="gap:8px;">
                <h3>Groups</h3>
                <div class="section-actions" style="display:flex;gap:8px;">
                    <button id="createGroupBtn" class="add-btn" style="display:none;" onclick="app.openCreateGroupModal()">Custom</button>
                    <button id="syncAllBtn" class="cancel-btn" onclick="app.syncAutoGroup()">Sync All</button>
                    <button class="close-btn" onclick="closeModal('groupsModal')">&times;</button>
                </div>
            </div>
            <div style="padding: 16px;">
                <div id="groupsList" class="items-list"></div>
            </div>
        </div>
    </div>

    <!-- Create Group Modal (Admin only) -->
    <div id="createGroupModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Custom Group</h3>
                <button class="close-btn" onclick="closeModal('createGroupModal')">&times;</button>
            </div>
            <form id="createGroupForm">
                <div class="form-group">
                    <label for="groupName">Group Name</label>
                    <input type="text" id="groupName" placeholder="Enter group name" required>
                </div>
                <div class="form-group">
                    <label for="groupBio">Bio</label>
                    <textarea id="groupBio" rows="3" placeholder="About this group"></textarea>
                </div>
                <div class="form-group">
                    <label for="groupPhoto">Profile Picture</label>
                    <input type="file" id="groupPhoto" accept="image/*">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Select Teachers</label>
                        <div id="createGroupTeachers" class="checkbox-group"></div>
                    </div>
                    <div class="form-group">
                        <label>Select Students</label>
                        <div id="createGroupStudents" class="checkbox-group"></div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('createGroupModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Create</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Group Settings Modal (Main Admin) -->
    <div id="groupSettingsModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Group Settings</h3>
                <button class="close-btn" onclick="closeModal('groupSettingsModal')">&times;</button>
            </div>
            <form id="groupSettingsForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editGroupName">Group Name</label>
                        <input type="text" id="editGroupName" required>
                    </div>
                    <div class="form-group">
                        <label for="editGroupPhoto">Profile Picture</label>
                        <input type="file" id="editGroupPhoto" accept="image/*">
                    </div>
                </div>
                <div class="form-group">
                    <label for="editGroupBio">Bio</label>
                    <textarea id="editGroupBio" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="groupWhoCanChat">Who can chat</label>
                    <select id="groupWhoCanChat">
                        <option value="all">Everyone</option>
                        <option value="teachers_only">Teachers only</option>
                        <option value="main_admin_only">Main admin only</option>
                        <option value="custom">Custom (select members)</option>
                    </select>
                </div>
                <div class="form-group" id="groupPermCustomWrap" style="display:none;">
                    <label>Select allowed members</label>
                    <div id="groupPermAllowed" class="checkbox-group"></div>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeModal('groupSettingsModal')">Cancel</button>
                    <button type="submit" class="submit-btn">Save</button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>